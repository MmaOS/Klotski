(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63639,       1464]
NotebookOptionsPosition[     62158,       1405]
NotebookOutlinePosition[     62514,       1421]
CellTagsIndexPosition[     62471,       1418]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Klotski", "Title",
 CellChangeTimes->{{3.65139277864779*^9, 3.651392785335121*^9}, 
   3.6514029737455997`*^9}],

Cell[CellGroupData[{

Cell["1\:3001\:5bfc\:5165\:6570\:636e", "Section",
 CellChangeTimes->{{3.651546239724661*^9, 3.651546243659661*^9}, {
  3.6517303987324133`*^9, 3.6517303992397566`*^9}, {3.6517412260343*^9, 
  3.6517412487685614`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "//", "Quiet"}], ";"}], 
  RowBox[{
  "(*", "\:6e05\:7a7aGlobal\:4e0a\:4e0b\:6587", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"path", "=", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], 
  RowBox[{"(*", "\:5f53\:524d\:8def\:5f84", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{"$ContextPath", ",", "\"\<Klotski`\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", 
   RowBox[{"(", 
    RowBox[{"path", "<>", "\"\<Klotski.wl\>\""}], ")"}]}], 
  RowBox[{"(*", "\:5bfc\:5165\:7a0b\:5e8f\:5305", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"path", "<>", "\"\<BeginData\\\\BeginData.txt\>\""}], "]"}]}], 
   ";"}], 
  RowBox[{
  "(*", "\:5bfc\:5165\:5168\:90e8\:5f00\:5c40\:6570\:636e", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"StringSplit", "[", 
       RowBox[{"#", ",", "\"\<\\n---\\n\>\""}], "]"}], "&"}], "/@", 
     RowBox[{"StringSplit", "[", 
      RowBox[{"data", ",", "\"\<\\n===\\n\>\""}], "]"}]}]}], ";"}], 
  RowBox[{
  "(*", "\:5206\:5272\:6570\:636e", "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.651546248503661*^9, 3.651546277715661*^9}, {
   3.651546308031661*^9, 3.6515464284856606`*^9}, {3.651546487291661*^9, 
   3.651546495159661*^9}, {3.6515587657001724`*^9, 3.6515587734879513`*^9}, {
   3.6515606252223682`*^9, 3.6515607024016495`*^9}, 3.65156166714324*^9, 
   3.651561863564952*^9, {3.651562462479837*^9, 3.6515625261792064`*^9}, {
   3.6515625700165896`*^9, 3.651562570686657*^9}, {3.651562602294817*^9, 
   3.6515626026658545`*^9}, 3.651562823016887*^9, 3.65156297465905*^9, {
   3.651563463297909*^9, 3.651563474785057*^9}, {3.6515635720917873`*^9, 
   3.6515635746550436`*^9}, {3.6515636862742043`*^9, 3.651563687342311*^9}, {
   3.6515638034429197`*^9, 3.651563809964572*^9}, {3.6515641127518473`*^9, 
   3.6515641280923815`*^9}, 3.6515643318417544`*^9, {3.6516503891428733`*^9, 
   3.6516504347447634`*^9}, {3.651650467524375*^9, 3.6516504828098564`*^9}, {
   3.6517081608834915`*^9, 3.6517082399228487`*^9}, 3.651708319356536*^9, {
   3.6517282899664207`*^9, 3.6517282914304647`*^9}, {3.6517300045970125`*^9, 
   3.651730018894212*^9}, {3.6517300660128174`*^9, 3.6517301526109095`*^9}, {
   3.6517302096646457`*^9, 3.6517302167241096`*^9}, {3.6517413369371624`*^9, 
   3.6517413486865606`*^9}, {3.651741490854356*^9, 3.651741493798791*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["2\:3001\:6c42\:89e3\:ff08\:5148\:8fd0\:884c1\:ff09", "Section",
 CellChangeTimes->{{3.651403107262585*^9, 3.6514031165694103`*^9}, 
   3.6514474346760116`*^9, {3.651730401236588*^9, 3.651730402317449*^9}, {
   3.6517412501610594`*^9, 3.6517412586435604`*^9}}],

Cell[CellGroupData[{

Cell["2.1\:3001\:5e7f\:5ea6\:4f18\:5148\:641c\:7d22\:ff08\:7528\:65f6\:7ea610\
\:79d2\:5de6\:53f3\:ff09", "Subsection",
 CellChangeTimes->{{3.6515488104717207`*^9, 3.6515488355992336`*^9}, 
   3.6517283148790426`*^9, {3.651728380009307*^9, 3.651728392035033*^9}, {
   3.651730419447488*^9, 3.651730420887515*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "==="}], "="}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\:53ef\:8c03\:53c2\:6570", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sK", "=", "1"}], ";", 
    RowBox[{"(*", "\:5f00\:5c40\:7f16\:53f7", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"kUp", "=", "50000"}], ";", 
    RowBox[{"(*", "\:641c\:7d22\:6b65\:9aa4\:4e0a\:9650", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"all", "=", "True"}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "True", "\:ff1a", "\:67e5\:627e\:6240\:6709\:89e3", "\:ff0c", "False", 
      "\:ff1a", "\:627e\:5230\:89e3\:5373\:9000\:51fa"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
        "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
       "===", "===", "===", "===", "===", "===", "===", "==="}], "="}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", "\:521d\:59cb\:5316\:6570\:636e", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"k", "=", "1"}], ";", 
    RowBox[{
    "(*", "\:5faa\:73af\:4e2d\:5f53\:524d\:961f\:5217\:5e8f\:53f7", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"n", "=", "1"}], ";", 
    RowBox[{
    "(*", "\:5b58\:50a8\:961f\:5217\:65f6\:4f7f\:7528\:7684\:5e8f\:53f7", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"startData", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"#", ",", "\"\< \>\""}], "]"}], "&"}], "/@", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"sK", ",", "3"}], "]"}], "]"}], ",", "\"\<\\n\>\""}], 
       "]"}]}]}], ";", 
    RowBox[{"(*", "\:5f00\:5c40\:6570\:636e", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"endData", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"#", ",", "\"\< \>\""}], "]"}], "&"}], "/@", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"sK", ",", "4"}], "]"}], "]"}], ",", "\"\<\\n\>\""}], 
       "]"}]}]}], ";", 
    RowBox[{"(*", "\:7ed3\:675f\:6570\:636e", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"endPos", "=", 
     RowBox[{"Position", "[", 
      RowBox[{"endData", ",", 
       RowBox[{"_", "?", "LetterQ"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"Heads", "\[Rule]", "False"}]}], "]"}]}], ";", 
    RowBox[{"(*", "\:7ed3\:675f\:65f6\:68cb\:5b50\:7684\:4f4d\:7f6e", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"endLetters", "=", 
     RowBox[{"Extract", "[", 
      RowBox[{"endData", ",", "endPos"}], "]"}]}], ";", 
    RowBox[{
    "(*", "\:7ed3\:675f\:65f6\:5bf9\:5e94\:4f4d\:7f6e\:4e0a\:7684\:68cb\:5b50\
\:5b57\:6bcd", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"packTypeRule", "=", 
     RowBox[{"letterToTypeN", "[", "startData", "]"}]}], ";", 
    RowBox[{"(*", "\:68cb\:5b50\:5206\:7c7b\:89c4\:5219", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"rows", "=", 
     RowBox[{"Length", "[", "startData", "]"}]}], ";", 
    RowBox[{"(*", "\:68cb\:76d8\:884c\:6570", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"columns", "=", 
     RowBox[{"Length", "[", 
      RowBox[{"startData", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
    RowBox[{"(*", "\:68cb\:76d8\:5217\:6570", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"vacancyN", "=", 
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "startData", "]"}], ",", "\"\<#\>\""}], 
      "]"}]}], ";", 
    RowBox[{"(*", "\:7a7a\:4f4d\:6570", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"fixedN", "=", 
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "startData", "]"}], ",", "\"\<@\>\""}], 
      "]"}]}], ";", 
    RowBox[{"(*", "\:56fa\:5b9a\:68cb\:5b50\:6570", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"successK", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{
    "(*", "\:5b58\:50a8\:641c\:7d22\:5230\:7684\:6210\:529f\:5c40\:9762\:7684\
\:5e8f\:53f7", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"queue", "=", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"1", "\[Rule]", 
        RowBox[{"pack", "[", "startData", "]"}]}], ",", 
       RowBox[{
        RowBox[{"packType", "[", 
         RowBox[{"startData", ",", "packTypeRule"}], "]"}], "\[Rule]", 
        "1"}]}], "|>"}]}], ";", 
    RowBox[{"(*", "\:521d\:59cb\:5316\:961f\:5217", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"operationRecord", "=", 
     RowBox[{"<|", "|>"}]}], ";", 
    RowBox[{"(*", "\:64cd\:4f5c\:8bb0\:5f55", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
        "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
       "===", "===", "===", "===", "===", "===", "===", "==="}], "="}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", "\:5b9e\:65f6\:663e\:793a\:641c\:7d22\:72b6\:6001", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"st", "=", 
     RowBox[{"SessionTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Dynamic", "@", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<\:5df2\:641c\:7d22\:5c40\:9762\:ff1a\>\"", ",", "k"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\:5df2\:7528\:65f6(\:79d2)\:ff1a\>\"", ",", 
          RowBox[{"NumberForm", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"SessionTime", "[", "]"}], "-", "st"}], ",", 
            RowBox[{"{", 
             RowBox[{"10", ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\:5df2\:67e5\:5230\:7ed3\:679c\:ff1a\>\"", ",", 
          RowBox[{"Length", "[", "successK", "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
       "===", "===", "===", "===", "===", "===", "==="}], "="}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\:5e7f\:5ea6\:4f18\:5148\:641c\:7d22", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"queue", ",", "k"}], "]"}], "&&", 
       RowBox[{"k", "<", "kUp"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"current", "=", 
        RowBox[{"unPack", "[", 
         RowBox[{
          RowBox[{"queue", "[", "k", "]"}], ",", "columns"}], "]"}]}], ";", 
       RowBox[{
       "(*", "\:4ece\:961f\:5217\:4e2d\:62bd\:53d6\:5f53\:524d\:5c40\:9762\
\:5e76\:89e3\:5305", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{"current", ",", "endPos"}], "]"}], "\[Equal]", 
          "endLetters"}], ",", 
         RowBox[{
         "(*", "\:5f53\:524d\:5c40\:9762\:4e3a\:6210\:529f\:5c40\:9762\:65f6\
\:7684\:5904\:7406\:8fc7\:7a0b", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"all", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"\:5982\:679c", " ", "all"}], "\[Equal]", "True"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"successK", ",", "k"}], "]"}], ";", 
            RowBox[{"(*", 
             RowBox[{"\:5b58\:50a8", " ", "k"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"k", "++"}], ";", 
            RowBox[{"Continue", "[", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"\:5982\:679c", " ", "all"}], "\[Equal]", "False"}], " ",
             "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"KeyDropFrom", "[", 
             RowBox[{"queue", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"StringReplace", "[", 
                 RowBox[{"#", ",", "packTypeRule"}], "]"}], "&"}], "/@", 
               RowBox[{"Lookup", "[", 
                RowBox[{"queue", ",", 
                 RowBox[{"Range", "[", 
                  RowBox[{
                   RowBox[{"k", "+", "1"}], ",", "n"}], "]"}]}], "]"}]}]}], 
             "]"}], ";", 
            RowBox[{
            "(*", "\:5220\:9664k\:4e4b\:540e\:7684\:6240\:6709\:6570\:636e", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"successK", ",", "k"}], "]"}], ";", 
            RowBox[{"(*", 
             RowBox[{"\:5b58\:50a8", " ", "k"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Break", "[", "]"}], ";"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"situations", "=", 
        RowBox[{"Klotski`moveToVacancy", "[", 
         RowBox[{
          RowBox[{"Klotski`vacancyAroundAMove", "[", 
           RowBox[{"current", ",", "rows", ",", "columns"}], "]"}], ",", 
          "current", ",", "vacancyN", ",", "fixedN"}], "]"}]}], ";", 
       RowBox[{
       "(*", "\:4ece\:5f53\:524d\:5c40\:9762\:53ef\:884d\:5316\:7684\:65b0\
\:5c40\:9762", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pickTF", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"!", 
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{"queue", ",", "#"}], "]"}]}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Klotski`packType", "[", 
             RowBox[{"#", ",", "packTypeRule"}], "]"}], "&"}], "/@", 
           "situations"}], ")"}]}]}], ";", 
       RowBox[{
       "(*", "\:54ea\:4e9b\:5c40\:9762\:5728\:961f\:5217\:4e2d\:672a\:66fe\
\:51fa\:73b0\:8fc7", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"nIncrease", "=", 
        RowBox[{"Count", "[", 
         RowBox[{"pickTF", ",", "True"}], "]"}]}], ";", 
       RowBox[{
       "(*", "\:961f\:5217\:4e2d\:672a\:66fe\:51fa\:73b0\:8fc7\:7684\:5c40\
\:9762\:6570\:91cf", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nIncrease", ">", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"situations", "=", 
           RowBox[{"Pick", "[", 
            RowBox[{"situations", ",", "pickTF"}], "]"}]}], ";", 
          RowBox[{
          "(*", "\:4fdd\:7559\:961f\:5217\:4e2d\:672a\:51fa\:73b0\:8fc7\:7684\
\:65b0\:5c40\:9762", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"i", "=", "1"}], ";", 
          RowBox[{"situationPacks", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"n", "+", 
               RowBox[{"i", "++"}]}], "\[Rule]", 
              RowBox[{"pack", "[", "#", "]"}]}], "&"}], "/@", 
            "situations"}]}], ";", 
          RowBox[{
          "(*", "\:5c06\:65b0\:5c40\:9762\:6253\:5305\:5e76\:6807\:8bb0\:5e8f\
\:53f7", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"i", "=", "1"}], ";", 
          RowBox[{"situationTypePacks", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Klotski`packType", "[", 
               RowBox[{"#", ",", "packTypeRule"}], "]"}], "\[Rule]", 
              RowBox[{"n", "+", 
               RowBox[{"i", "++"}]}]}], "&"}], "/@", "situations"}]}], ";", 
          RowBox[{
          "(*", "\:5c06\:65b0\:5c40\:9762\:6309\:7c7b\:6253\:5305\:5e76\:6807\
\:8bb0\:5e8f\:53f7", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"AssociateTo", "[", 
           RowBox[{"queue", ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"situationPacks", ",", "situationTypePacks"}], "}"}], 
             "]"}]}], "]"}], ";", 
          RowBox[{
          "(*", "\:5c06\:4e24\:79cd\:5305\:52a0\:5165\:5230\:961f\:5217\:4e2d\
", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"AssociateTo", "[", 
           RowBox[{"operationRecord", ",", 
            RowBox[{"k", "\[Rule]", 
             RowBox[{"n", "+", 
              RowBox[{"Range", "[", "nIncrease", "]"}]}]}]}], "]"}], ";", 
          RowBox[{"(*", "\:5b58\:50a8\:64cd\:4f5c\:8bb0\:5f55", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"n", "+=", "nIncrease"}], ";"}]}], 
        RowBox[{"(*", "\:589e\:52a0\:5b58\:50a8\:5e8f\:53f7\:503c", "*)"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"k", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "\:7ed3\:679c\:53ef\:901a\:8fc7", " ", "operationRecord", " ", "\:4ece", 
      " ", "queue", " ", "\:4e2d\:63d0\:53d6"}], "*)"}], 
    "\[IndentingNewLine]"}]}]}]], "Input",
 CellChangeTimes->{{3.651403172423725*^9, 3.6514031890420656`*^9}, {
   3.6514032276659775`*^9, 3.651403262541557*^9}, {3.651403325549939*^9, 
   3.6514033383696985`*^9}, {3.6514033783037558`*^9, 3.651403458540462*^9}, {
   3.651403548076647*^9, 3.6514035533232217`*^9}, {3.6514036177072973`*^9, 
   3.651403620156191*^9}, {3.6514038765936785`*^9, 3.6514038950580826`*^9}, {
   3.6514039320037117`*^9, 3.651403955186736*^9}, {3.6514460465722284`*^9, 
   3.651446192485405*^9}, {3.6514462712931633`*^9, 3.6514462756270304`*^9}, {
   3.6514463143367705`*^9, 3.6514463205550137`*^9}, {3.6514467931408644`*^9, 
   3.651446807326283*^9}, {3.651446925557105*^9, 3.651446997055254*^9}, 
   3.651447136649212*^9, {3.6514473381533604`*^9, 3.651447364573002*^9}, {
   3.651447486912235*^9, 3.6514475454740906`*^9}, {3.6514475881723595`*^9, 
   3.6514476109006324`*^9}, {3.65144765078162*^9, 3.6514476950870504`*^9}, {
   3.651447799115452*^9, 3.651447868227827*^9}, {3.6514479865339956`*^9, 
   3.6514480558130665`*^9}, {3.6514481209285975`*^9, 
   3.6514484621995974`*^9}, {3.651448494604597*^9, 3.6514485126085973`*^9}, {
   3.651490979207099*^9, 3.6514910265058765`*^9}, 3.651547893337017*^9, {
   3.6515479418778706`*^9, 3.651547950227705*^9}, {3.6515604394565315`*^9, 
   3.651560457056291*^9}, {3.6515615263162403`*^9, 3.65156152642824*^9}, {
   3.6515617534609423`*^9, 3.6515617552151175`*^9}, {3.651561888233418*^9, 
   3.651561911625757*^9}, {3.6515620462222157`*^9, 3.6515620663702297`*^9}, {
   3.6515622727958703`*^9, 3.651562297821373*^9}, 3.6515626418907766`*^9, 
   3.651563139504533*^9, {3.6515632828798685`*^9, 3.651563307975378*^9}, {
   3.651563427613341*^9, 3.6515634617857575`*^9}, {3.651564142319804*^9, 
   3.651564148639436*^9}, {3.6515643114477153`*^9, 3.651564312166787*^9}, {
   3.6517031069068437`*^9, 3.6517031294241533`*^9}, {3.651708312580872*^9, 
   3.65170835947479*^9}, {3.6517089774763403`*^9, 3.651709026182997*^9}, {
   3.6517091267177005`*^9, 3.6517091318375187`*^9}, {3.6517094224552603`*^9, 
   3.651709424114024*^9}, 3.6517095831854763`*^9, {3.651728320998297*^9, 
   3.6517283572959447`*^9}, {3.651728400586313*^9, 3.6517288352052765`*^9}, {
   3.651741330753357*^9, 3.651741331635997*^9}, {3.6517414977996426`*^9, 
   3.6517414982440395`*^9}, {3.651741584097603*^9, 3.6517415971918826`*^9}, {
   3.6517426127130685`*^9, 3.6517426160685873`*^9}, {3.6517431017586017`*^9, 
   3.6517431224897614`*^9}, {3.6517432312509212`*^9, 
   3.6517432315603695`*^9}, {3.6517436774145684`*^9, 3.6517436935735188`*^9}, 
   3.651745127198948*^9, 3.651745237794011*^9}],

Cell[BoxData[
 DynamicBox[ToBoxes[
   Grid[{{"\:5df2\:641c\:7d22\:5c40\:9762\:ff1a", $CellContext`k}, {
     "\:5df2\:7528\:65f6(\:79d2)\:ff1a", 
      NumberForm[SessionTime[] - $CellContext`st, {10, 2}]}, {
     "\:5df2\:67e5\:5230\:7ed3\:679c\:ff1a", 
      Length[$CellContext`successK]}}, Alignment -> Left], StandardForm],
  ImageSizeCache->{145., {22.5, 29.5}}]], "Output",
 CellChangeTimes->{
  3.6517097371298943`*^9, {3.6517283461174035`*^9, 3.651728360178653*^9}, 
   3.6517288870242414`*^9, 3.651741601597519*^9, 3.6517421491073446`*^9, {
   3.6517422010394163`*^9, 3.651742228705639*^9}, 3.651742311735196*^9, 
   3.6517425005908003`*^9, {3.6517425424263763`*^9, 3.6517425463932056`*^9}, 
   3.6517426204230113`*^9, 3.6517426697667856`*^9, 3.651742743007223*^9, 
   3.6517429651336703`*^9, {3.651743129424381*^9, 3.6517431439640017`*^9}, 
   3.6517432353623705`*^9, 3.651743287665103*^9, 3.6517433276808467`*^9, 
   3.6517434066852374`*^9, 3.6517434897948217`*^9, 3.651743544794408*^9, {
   3.651743588048485*^9, 3.651743628624424*^9}, 3.651743678138298*^9, 
   3.6517438482775435`*^9, 3.651744218316708*^9, 3.651744260215108*^9, {
   3.6517442987228727`*^9, 3.6517443042799673`*^9}, 3.6517444422379255`*^9, {
   3.6517444759249096`*^9, 3.651744479706951*^9}, 3.651744587859121*^9, 
   3.651745132060784*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3\:3001\:6574\:7406\:7ed3\:679c\:ff08\:5148\:8fd0\:884c1\:ff0c2\:ff09", \
"Section",
 CellChangeTimes->{{3.6513928721344404`*^9, 3.651392874086245*^9}, {
  3.651651515439732*^9, 3.6516515191460705`*^9}, {3.651730404197624*^9, 
  3.6517304047085648`*^9}, {3.6517412626087*^9, 3.6517412662104626`*^9}, {
  3.651741565274035*^9, 3.651741565593261*^9}}],

Cell[CellGroupData[{

Cell["3.1\:3001\:5bf9\:6bcf\:4e2a\:89e3\:5206\:522b\:8c03\:6574\:987a\:5e8f\
\:ff0c\:663e\:793a\:6b65\:9aa4\:6570\:ff08\:8fde\:7eed\:79fb\:52a8\:4e24\:6b21\
\:53ea\:8bb0\:4e00\:6b21\:ff09\:ff0c\:4fdd\:5b58\:7ed3\:679c\:81f3\:53d8\:91cf\
\:ff1asolveBriefCode", "Subsection",
 CellChangeTimes->{{3.651475578626746*^9, 3.651475600056031*^9}, 
   3.651642652227292*^9, {3.65164274256238*^9, 3.6516428086127234`*^9}, {
   3.651729816561756*^9, 3.651729820097508*^9}, {3.651730429539856*^9, 
   3.651730431431148*^9}}],

Cell["\<\
\:7531\:4e8e\:4eba\:548c\:8ba1\:7b97\:673a\:5bf9\:79fb\:52a8\:6b65\:9aa4\:7684\
\:8ba4\:8bc6\:4e0d\:540c\:ff0c\:4eba\:5bf9\:4e8e\:540c\:4e00\:68cb\:5b50\:8fde\
\:7eed\:79fb\:52a8\:4e24\:6b21\:8ba4\:4e3a\:662f\:4e00\:6b21\:ff0c\:800c\:8ba1\
\:7b97\:673a\:8ba4\:4e3a\:662f\:4e24\:6b21\:3002
\:4e0b\:9762\:7684\:8fc7\:7a0b\:53ea\:5b9e\:73b0\:4e86\:57fa\:672c\:8c03\:6574\
\:ff0c\:5e76\:672a\:8fbe\:5230\:6700\:4f18\:987a\:5e8f\:3002
\:5f85\:6539\:5584\[Ellipsis]\[Ellipsis]\
\>", "Text",
 CellChangeTimes->{{3.6517289272248554`*^9, 3.651729066602086*^9}, {
  3.6517290970821977`*^9, 3.6517291201830387`*^9}, {3.6517304371739593`*^9, 
  3.65173044337043*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"solveStatus", "=", 
    RowBox[{"sortSolve", "[", 
     RowBox[{"queue", ",", "operationRecord", ",", "successK"}], "]"}]}], 
   ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:901a\:8fc7", " ", "operationRecord", " ", "\:548c", " ", "queue", " ", 
    "\:5f97\:5230", " ", "solveStatus", 
    RowBox[{"\:ff08", "\:72b6\:6001\:5f62\:5f0f\:7684\:89e3", "\:ff09"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solveBriefCode", "=", 
    RowBox[{"{", "}"}]}], ";"}], 
  RowBox[{
  "(*", "\:7528\:4e8e\:5b58\:50a8\:8c03\:6574\:987a\:5e8f\:4e4b\:540e\:7684\
\:89e3\:6570\:636e", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sPkStepn", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"cmTF", "=", 
        RowBox[{"chessmanToPosFromPos", "[", 
         RowBox[{
          RowBox[{"solveStatus", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", "columns"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "\:5c06\:7ed3\:679c\:8f6c\:4e3a", "\:ff1a", "\:68cb\:5b50", "\:ff0c", 
         "\:76ee\:6807\:7a7a\:4f4d", "\:ff0c", "\:817e\:51fa\:7a7a\:4f4d"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"briefCodeLive", "=", 
        RowBox[{"StringSplit", "[", 
         RowBox[{"toFlow", "[", 
          RowBox[{
           RowBox[{"solveStatus", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", "columns"}], "]"}], "]"}]}], 
       ";", 
       RowBox[{"(*", 
        RowBox[{
        "\:5c06\:7ed3\:679c\:8f6c\:4e3a\:7b80\:8bb0\:7801", "\:ff0c", 
         "\:5373\:79fb\:52a8\:8fc7\:7a0b"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"letters", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"cmTF", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", "\"\<#\>\"", "}"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "\:7528\:5230\:7684\:68cb\:5b50", "\:ff1a", "\:5b57\:6bcd", "\:ff0c", 
         "\:4e0d\:542b\:7a7a\:4f4d"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"flag", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"flag", ">", "0"}], 
         RowBox[{"(*", 
          RowBox[{
          "\:4e00\:76f4\:5faa\:73af", "\:ff0c", 
           "\:76f4\:5230\:987a\:5e8f\:4e0d\:518d\:53d8\:5316"}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"flag", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"pos", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Position", "[", 
                RowBox[{"cmTF", ",", 
                 RowBox[{"{", 
                  RowBox[{"letter", ",", "_", ",", "_"}], "}"}]}], "]"}], 
               "]"}]}], ";", 
             RowBox[{
             "(*", "\:8be5\:5b57\:6bcd\:6240\:5728\:7684\:6240\:6709\:4f4d\
\:7f6e", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"nn", "=", 
              RowBox[{
               RowBox[{"Length", "[", "pos", "]"}], "-", "1"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"kk", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}]}], ">", "1"}], 
                   RowBox[{
                   "(*", "\:4e24\:4e2a\:5b57\:6bcd\:4e0d\:76f8\:90bb", "*)"}],
                    "&&", 
                   RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"cmTF", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}], ";;", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"kk", "+", "1"}], "]"}], "]"}]}], ",", "3"}], 
                    "]"}], "]"}], ",", "1"}], "]"}], ",", 
                    RowBox[{"cmTF", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"kk", "+", "1"}], "]"}], "]"}], ",", "2"}], "]"}],
                     "]"}]}], "]"}], "==", 
                    RowBox[{"{", "}"}]}]}], 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"\:5728kk", "+", 
                    RowBox[{
                    "1", "\:6b21\:64cd\:4f5c\:8be5\:5b57\:6bcd\:65f6"}]}], 
                    "\:ff0c", 
                    "\:8be5\:5b57\:6bcd\:7684\:6bcf\:4e2a\:76ee\:6807\:7a7a\
\:4f4d\:5728\:4e0a\:4e00\:6b21\:64cd\:4f5c\:8be5\:5b57\:6bcd\:4e4b\:540e\:4e00\
\:76f4\:5b58\:5728"}], "*)"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"briefCodeLive", "=", 
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Insert", "[", 
                    RowBox[{"briefCodeLive", ",", 
                    RowBox[{"briefCodeLive", "[", 
                    RowBox[{"[", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"kk", "+", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}], "+", "1"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"kk", "+", "1"}], "]"}], "]"}], "+", "1"}]}], 
                    "]"}]}], ";", 
                   RowBox[{
                   "(*", "\:82e5\:6ee1\:8db3\:4e0a\:9762\:4e24\:4e2a\:6761\
\:4ef6\:5219\:79fb\:52a8\:4e4b", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"flag", "++"}], ";"}]}], "]"}], ";"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"kk", ",", "nn"}], "}"}]}], "]"}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"letter", ",", "letters"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cmTF", "=", 
           RowBox[{"chessmanToPosFromPos", "[", 
            RowBox[{
             RowBox[{"fromBriefCode", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringRiffle", "[", 
                 RowBox[{"Flatten", "[", "startData", "]"}], "]"}], "<>", 
                "\"\<:\>\"", "<>", 
                RowBox[{"StringRiffle", "[", 
                 RowBox[{"briefCodeLive", ",", "\"\< \>\""}], "]"}]}], ",", 
               "columns"}], "]"}], ",", "columns"}], "]"}]}], ";"}]}], 
        RowBox[{"(*", "\:66f4\:65b0cmTF", "*)"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"solveBriefCode", ",", 
         RowBox[{
          RowBox[{"solveStatus", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "<>", "\"\<:\>\"", "<>", 
          RowBox[{"StringRiffle", "[", 
           RowBox[{"briefCodeLive", ",", "\"\< \>\""}], "]"}]}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{"Differences", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", "briefCodeLive"}],
             "]"}], ",", "Plus", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}]}], "}"}]}], 
      RowBox[{"(*", "\:8f93\:51fa\:5230\:8868\:4e2d", "*)"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "[", "solveStatus", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], 
  RowBox[{
  "(*", "\:5bf9\:6bcf\:4e2a\:89e3\:5206\:522b\:8c03\:6574\:987a\:5e8f", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SortBy", "[", 
   RowBox[{"sPkStepn", ",", "Last"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"\:7b2cn\:4e2a\:89e3", "\:ff0c", "\:6b65\:9aa4\:6570"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.6514766379817348`*^9, {3.651476701474083*^9, 3.6514767353954754`*^9}, {
   3.65147680835077*^9, 3.651476814060341*^9}, {3.6514768467386084`*^9, 
   3.6514768647404084`*^9}, {3.6514779623911624`*^9, 
   3.6514779876806912`*^9}, {3.6514781076196837`*^9, 3.651478124053327*^9}, {
   3.651478158604782*^9, 3.651478159129834*^9}, {3.6514781918531065`*^9, 
   3.651478242510172*^9}, {3.651478286743594*^9, 3.6514783853764567`*^9}, {
   3.651478423131232*^9, 3.651478484852403*^9}, {3.6514785374586635`*^9, 
   3.651478557667684*^9}, {3.651478604701387*^9, 3.651478635685485*^9}, {
   3.651478681033019*^9, 3.6514786860515213`*^9}, {3.651478923874301*^9, 
   3.6514789513750505`*^9}, {3.6514790783947515`*^9, 3.651479110716984*^9}, 
   3.651549446116279*^9, 3.6515495283495016`*^9, 3.651549559648631*^9, 
   3.651549616010267*^9, {3.651549648703536*^9, 3.6515496793445997`*^9}, {
   3.6515500167363358`*^9, 3.651550018373499*^9}, {3.6515513554101896`*^9, 
   3.6515513660822563`*^9}, {3.651555700054643*^9, 3.6515557619388313`*^9}, {
   3.651555803187956*^9, 3.651555832964933*^9}, {3.6515559382434597`*^9, 
   3.6515559388965254`*^9}, {3.65155598134977*^9, 3.651556021720807*^9}, {
   3.6515573118528023`*^9, 3.6515573119868155`*^9}, {3.651638607631497*^9, 
   3.651638614549743*^9}, {3.651639071603759*^9, 3.651639071939997*^9}, {
   3.651639144045621*^9, 3.6516391844945803`*^9}, {3.651639266157261*^9, 
   3.6516394450032434`*^9}, 3.651639481903721*^9, {3.6516395701560745`*^9, 
   3.651639623405137*^9}, {3.651639675534832*^9, 3.6516396756686835`*^9}, {
   3.6516401478450766`*^9, 3.651640150403925*^9}, {3.651640406637472*^9, 
   3.6516404928571577`*^9}, 3.65164063492266*^9, {3.6516411256905985`*^9, 
   3.651641166283362*^9}, {3.651642003669604*^9, 3.6516421187959633`*^9}, {
   3.6516421513484154`*^9, 3.651642323034316*^9}, {3.651642355774343*^9, 
   3.6516423878674793`*^9}, {3.6516424431460886`*^9, 
   3.6516426480917063`*^9}, {3.651642688986483*^9, 3.651642733816843*^9}, {
   3.6516429652249813`*^9, 3.651643151498069*^9}, {3.651646278230627*^9, 
   3.6516462872791176`*^9}, 3.65164928002091*^9, {3.6516508019343987`*^9, 
   3.6516508250084686`*^9}, {3.6516508558342147`*^9, 
   3.6516508633241816`*^9}, {3.651650969722921*^9, 3.651650995870242*^9}, {
   3.6516510589472094`*^9, 3.6516510628173747`*^9}, {3.651651109459944*^9, 
   3.6516511100536737`*^9}, {3.6516512000377398`*^9, 
   3.6516512030209217`*^9}, {3.6516514172290926`*^9, 
   3.6516514229888496`*^9}, {3.65170319253546*^9, 3.651703195493405*^9}, {
   3.6517093010968227`*^9, 3.6517093249750247`*^9}, {3.651709364184087*^9, 
   3.651709516104229*^9}, {3.651709575663434*^9, 3.6517095789100533`*^9}, 
   3.6517097464788494`*^9, {3.6517298101542587`*^9, 3.651729875599701*^9}, {
   3.6517299061443777`*^9, 3.6517299811326857`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "87"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "89"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "90"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "92"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "103"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "105"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "107"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "108"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6514779684557686`*^9, 3.651477998043727*^9}, {
   3.6514781195768795`*^9, 3.6514781248664083`*^9}, {3.651478201550076*^9, 
   3.6514782429072113`*^9}, {3.6514783275026703`*^9, 3.651478385900509*^9}, 
   3.6514784331442327`*^9, {3.6514784674286613`*^9, 3.651478485564474*^9}, {
   3.6514785403419514`*^9, 3.651478558358753*^9}, {3.6514786093808546`*^9, 
   3.6514786361405306`*^9}, 3.651478686901606*^9, 3.6514792044533563`*^9, {
   3.6515496522508907`*^9, 3.651549680068672*^9}, 3.651550018655527*^9, 
   3.651551260428692*^9, {3.65155136661831*^9, 3.6515513740120497`*^9}, {
   3.651555727149352*^9, 3.6515557341850557`*^9}, 3.65155583393403*^9, 
   3.651555939635599*^9, {3.6515559912037554`*^9, 3.651556021914826*^9}, 
   3.6515573130029173`*^9, 3.651562689961583*^9, 3.65156272393798*^9, 
   3.651624276225898*^9, 3.6516354985406523`*^9, 3.6516396283335094`*^9, 
   3.6516396765373173`*^9, 3.651640162842326*^9, 3.6516402071005154`*^9, {
   3.651640412280224*^9, 3.6516404932404184`*^9}, 3.651640637949581*^9, 
   3.6516411261992292`*^9, 3.65164116288404*^9, {3.651642074787655*^9, 
   3.6516421190976195`*^9}, 3.6516421959817605`*^9, {3.6516422426605415`*^9, 
   3.6516422681123347`*^9}, 3.6516431131367474`*^9, 3.651643152746174*^9, 
   3.6516492891906815`*^9, 3.651650890600136*^9, {3.651650972518488*^9, 
   3.65165099753277*^9}, 3.6516510713827467`*^9, 3.6516512043826714`*^9, 
   3.651651479205798*^9, 3.651703175771329*^9, 3.65170916341372*^9, 
   3.651709753506562*^9, 3.6517291233442926`*^9, 3.6517298495019093`*^9, 
   3.6517299873659973`*^9, 3.6517427921939573`*^9, 3.651743364909023*^9, 
   3.651744339442225*^9, 3.651744509108214*^9, 3.651744618928864*^9, 
   3.651745145808173*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["4\:3001\:7ed3\:679c\:5c55\:793a", "Section",
 CellChangeTimes->{{3.6513928952171316`*^9, 3.6513929013195214`*^9}, {
   3.651492470179164*^9, 3.6514924721812563`*^9}, {3.651730406324774*^9, 
   3.6517304099829144`*^9}, {3.6517412684258337`*^9, 3.6517412714415073`*^9}, 
   3.651741551511795*^9}],

Cell[CellGroupData[{

Cell["\:5c55\:793a\:5f53\:524d\:8ba1\:7b97\:7684\:89e3\:6570\:636e\:ff08\:884c\
\:8fd0\:884c1\:ff0c2\:ff0c3\:ff09", "Subsection",
 CellChangeTimes->{{3.6517302801690135`*^9, 3.6517302973725777`*^9}, {
  3.6517415532291594`*^9, 3.6517415622575407`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\:53ef\:8c03\:53c2\:6570", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"k", "=", "3"}], ";", 
    RowBox[{"(*", "\:9009\:62e9\:5c55\:793a\:54ea\:4e00\:4e2a\:89e3", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"time", "=", "0.5"}], ";", 
    RowBox[{"(*", "\:95f4\:9694\:65f6\:95f4", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
        "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
       "===", "===", "===", "===", "===", "===", "===", "==="}], "="}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"da", "=", 
     RowBox[{"fromBriefCode", "[", 
      RowBox[{
       RowBox[{"solveBriefCode", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", "columns"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "\:4ece\:7b80\:8bb0\:7801\:8f6c\:6362\:4e3a\:77e9\:9635\:5f62\:5f0f\:7684\
\:6570\:636e", "\:ff0c", "\:4ee5\:4fbf\:5c55\:793a"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"allLetters", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{
         RowBox[{"da", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \>\""}], "]"}], ",", 
       RowBox[{"(", 
        RowBox[{"\"\<@\>\"", "|", "\"\<#\>\""}], ")"}]}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "\:6240\:6709\:4e0d\:540c\:7684\:68cb\:5b50", "\:ff0c", 
      "\:53bb\:9664\:7a7a\:4f4d\:548c\:56fa\:5b9a\:68cb\:5b50"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"colorRules", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<@\>\"", "\[Rule]", 
         RowBox[{"GrayLevel", "[", "0.3", "]"}]}], ",", 
        RowBox[{"\"\<#\>\"", "\[Rule]", "Black"}], ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"allLetters", "\[Rule]", 
          RowBox[{
           RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "/@", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "[", "allLetters", "]"}]}], "]"}]}]}], "]"}]}],
        "}"}], "]"}]}], ";", 
    RowBox[{"(*", "\:989c\:8272\:89c4\:5219", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"kk", "=", 
     RowBox[{"nn", "=", 
      RowBox[{"Length", "[", "da", "]"}]}]}], ";", 
    RowBox[{"(*", "\:89e3\:7684\:957f\:5ea6", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Dynamic", "[", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{"kk", ",", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"unPack", "[", 
           RowBox[{
            RowBox[{"da", "[", 
             RowBox[{"[", "kk", "]"}], "]"}], ",", "columns"}], "]"}], ",", 
          RowBox[{"Background", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", "None", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"unPack", "[", 
                    RowBox[{
                    RowBox[{"da", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}], ",", "columns"}], "]"}], 
                    ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "->", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
                "colorRules"}], ",", "1"}], "]"}]}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", "None", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"CoordinateBounds", "[", 
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"unPack", "[", 
                    RowBox[{
                    RowBox[{"da", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}], ",", "columns"}], "]"}], 
                    ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "\[Rule]",
                   "True"}], "&"}], "/@", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"colorRules", ",", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<#\>\"", "\[Rule]", "_"}], ")"}], "|", 
                    RowBox[{"(", 
                    RowBox[{"\"\<@\>\"", "\[Rule]", "_"}], ")"}]}], ")"}]}], 
                 "]"}]}], ")"}], "~", "Join", "~", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"unPack", "[", 
                   RowBox[{
                    RowBox[{"da", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}], ",", "columns"}], "]"}], 
                  ",", "\"\<#\>\""}], "]"}], "\[Rule]", "True"}], "]"}], "~", 
              "Join", "~", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"unPack", "[", 
                   RowBox[{
                    RowBox[{"da", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}], ",", "columns"}], "]"}], 
                  ",", "\"\<@\>\""}], "]"}], "\[Rule]", "True"}], "]"}]}]}], 
            "}"}]}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Thickness", "[", "3", "]"}], ",", "Black"}], "]"}]}], 
          ",", 
          RowBox[{"ItemSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"2.5", ",", "3"}], "}"}]}], ",", 
          RowBox[{"Spacings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}]}], ",", 
          RowBox[{"Alignment", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Center", ",", "Center"}], "}"}]}], ",", 
          RowBox[{"ItemStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Section\>\"", ",", "Black"}], "}"}]}]}], "]"}]}], 
       "}"}], "]"}], "]"}]}], 
   RowBox[{"(*", "\:5c55\:793a", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Pause", "[", "time", "]"}], ";"}], ",", 
      RowBox[{"{", 
       RowBox[{"kk", ",", "nn"}], "}"}]}], "]"}], ";", 
    RowBox[{"(*", "\:66f4\:65b0\:6b65\:9aa4kk", "*)"}], 
    "\[IndentingNewLine]"}]}]}]], "Input",
 CellChangeTimes->{{3.651390618630105*^9, 3.6513906848797293`*^9}, {
   3.65139072048629*^9, 3.6513907633815784`*^9}, {3.651391143801617*^9, 
   3.6513911535605927`*^9}, {3.6513913867409086`*^9, 3.651391388493084*^9}, {
   3.651392610312254*^9, 3.6513926173729596`*^9}, {3.651401599832677*^9, 
   3.651401600914336*^9}, 3.651402803186326*^9, {3.651402836866322*^9, 
   3.651402841029724*^9}, 3.6514030299929104`*^9, {3.651462899747016*^9, 
   3.6514629458296237`*^9}, {3.6515489117478476`*^9, 
   3.6515490730169725`*^9}, {3.651549159105581*^9, 3.6515491894826183`*^9}, {
   3.6515492362302923`*^9, 3.651549239397609*^9}, {3.65156153492924*^9, 
   3.65156154409024*^9}, {3.6515644126858377`*^9, 3.6515644171072803`*^9}, {
   3.651643270007372*^9, 3.6516433170238523`*^9}, {3.6516433473950715`*^9, 
   3.6516433479711037`*^9}, 3.651643652424024*^9, 3.6516443349243946`*^9, {
   3.651644379420037*^9, 3.6516443804884634`*^9}, {3.651644416112956*^9, 
   3.6516444398073235`*^9}, 3.6516445143037186`*^9, {3.6516445793195477`*^9, 
   3.651644580161332*^9}, {3.6516446782948823`*^9, 3.6516446810472813`*^9}, {
   3.6516447325014496`*^9, 3.6516447848313155`*^9}, {3.6516448291133223`*^9, 
   3.6516448431364765`*^9}, {3.651644886631585*^9, 3.6516448900891924`*^9}, {
   3.651644928488295*^9, 3.6516449288395443`*^9}, {3.651644989393998*^9, 
   3.6516450465397215`*^9}, {3.6516450779449153`*^9, 
   3.6516450817143273`*^9}, {3.6516451150075293`*^9, 
   3.6516451452148705`*^9}, {3.6516451854579124`*^9, 3.651645196824551*^9}, {
   3.651645429729638*^9, 3.6516454590298033`*^9}, {3.651650825028495*^9, 
   3.651650825029984*^9}, {3.65165123305465*^9, 3.651651264993659*^9}, 
   3.6516512999086294`*^9, {3.6516514884427376`*^9, 3.65165148942373*^9}, {
   3.651651751363784*^9, 3.6516518280588727`*^9}, 3.6516519507458515`*^9, {
   3.651652134476822*^9, 3.651652144861143*^9}, {3.6516521749628506`*^9, 
   3.651652246739506*^9}, {3.65165234202626*^9, 3.6516523661467495`*^9}, 
   3.651652434510981*^9, {3.6516524887031813`*^9, 3.6516525069333467`*^9}, {
   3.651652578059436*^9, 3.6516525945128746`*^9}, {3.651652661520856*^9, 
   3.651652668344904*^9}, {3.6516527027773967`*^9, 3.651652703291401*^9}, {
   3.651652810460178*^9, 3.651652816716285*^9}, {3.6516528651731386`*^9, 
   3.6516528947953196`*^9}, {3.651660614628791*^9, 3.651660614880247*^9}, {
   3.651660666781864*^9, 3.6516606669782066`*^9}, {3.6517032515187635`*^9, 
   3.651703277079315*^9}, {3.651729173179803*^9, 3.651729507097212*^9}, {
   3.6517295436286755`*^9, 3.651729567612462*^9}, {3.6517296162291727`*^9, 
   3.6517296197675996`*^9}, {3.6517296759078856`*^9, 
   3.6517296970833893`*^9}, {3.6517446762058573`*^9, 
   3.6517446997310658`*^9}, {3.651744803631625*^9, 3.6517448125608606`*^9}, 
   3.651744886443693*^9, 3.6517451949122224`*^9}],

Cell[BoxData[
 DynamicBox[ToBoxes[
   Column[{$CellContext`kk, 
     Grid[
      Klotski`unPack[
       Part[$CellContext`da, $CellContext`kk], $CellContext`columns], 
      Background -> {None, None, 
        Flatten[
         Map[Thread[Position[
             Klotski`unPack[
              Part[$CellContext`da, $CellContext`kk], $CellContext`columns], 
             Part[#, 1]] -> Part[#, 2]]& , $CellContext`colorRules], 1]}, 
      Frame -> {None, None, 
        Join[
         Join[
          Map[CoordinateBounds[
             Position[
              Klotski`unPack[
               Part[$CellContext`da, $CellContext`kk], $CellContext`columns], 
              Part[#, 1]]] -> True& , 
           DeleteCases[$CellContext`colorRules, 
            Alternatives["#" -> Blank[], "@" -> Blank[]]]], 
          Thread[Position[
             Klotski`unPack[
              Part[$CellContext`da, $CellContext`kk], $CellContext`columns], 
             "#"] -> True]], 
         Thread[Position[
            Klotski`unPack[
             Part[$CellContext`da, $CellContext`kk], $CellContext`columns], 
            "@"] -> True]]}, FrameStyle -> Directive[
        Thickness[3], Black], ItemSize -> {2.5, 3}, Spacings -> {3, 3}, 
      Alignment -> {Center, Center}, ItemStyle -> {"Section", Black}]}], 
   StandardForm],
  ImageSizeCache->{305., {179.5, 186.5}}]], "Output",
 CellChangeTimes->{{3.6513906775890007`*^9, 3.6513906853407755`*^9}, {
   3.6513907265858994`*^9, 3.6513907317804193`*^9}, 3.6513907652217627`*^9, 
   3.6513909603362722`*^9, {3.6513911515653934`*^9, 3.651391153811618*^9}, 
   3.651391363300565*^9, 3.651391505948828*^9, 3.65139172618785*^9, 
   3.6513921815113773`*^9, 3.651392410898314*^9, 3.651392620005223*^9, 
   3.6514016014974976`*^9, 3.6514027396791086`*^9, 3.651402804042385*^9, 
   3.651402841558647*^9, {3.651403007896023*^9, 3.6514030302200713`*^9}, 
   3.6514628701640577`*^9, {3.651462903011342*^9, 3.651462946914732*^9}, 
   3.651470810993085*^9, 3.651490157617524*^9, 3.6515488912698*^9, 
   3.6515489382775*^9, {3.651549044292101*^9, 3.651549074171088*^9}, 
   3.6515491908217525`*^9, {3.651549222790949*^9, 3.6515492422018895`*^9}, 
   3.6515523399232225`*^9, 3.651562729743561*^9, {3.6515630587044535`*^9, 
   3.651563063390922*^9}, 3.6516242821402197`*^9, {3.651643331542152*^9, 
   3.6516433486005735`*^9}, 3.651643652830773*^9, 3.6516443353511686`*^9, 
   3.651644382313808*^9, {3.65164442258183*^9, 3.6516444414505787`*^9}, 
   3.6516445148144445`*^9, {3.651644807916749*^9, 3.651644843433627*^9}, 
   3.6516449310382743`*^9, {3.6516449899830775`*^9, 3.6516450469558845`*^9}, 
   3.651645082411161*^9, {3.651645119135144*^9, 3.6516451270524054`*^9}, {
   3.651645176092016*^9, 3.6516451975657997`*^9}, 3.651645430973888*^9, {
   3.651645461761304*^9, 3.6516454879435*^9}, {3.651651213124364*^9, 
   3.651651268559127*^9}, 3.6516513007476673`*^9, 3.651651544289234*^9, {
   3.651651751928308*^9, 3.6516518283652587`*^9}, 3.6516519512090244`*^9, 
   3.6516520216297903`*^9, 3.651652145443923*^9, {3.651652184403923*^9, 
   3.651652248573126*^9}, {3.6516523445346527`*^9, 3.651652366394273*^9}, 
   3.651652434822685*^9, {3.6516524965724955`*^9, 3.651652509689017*^9}, {
   3.651652579506983*^9, 3.6516525963784246`*^9}, {3.651652812377116*^9, 
   3.6516528172178063`*^9}, {3.6516528662897277`*^9, 3.6516528950227404`*^9}, 
   3.651660615235136*^9, {3.651660646951939*^9, 3.651660680600191*^9}, {
   3.651703269795704*^9, 3.651703277882887*^9}, 3.6517291344660835`*^9, 
   3.651729460579441*^9, {3.651729492010956*^9, 3.6517295191288033`*^9}, 
   3.651729697963681*^9, {3.6517427893527536`*^9, 3.6517427939524155`*^9}, {
   3.651743359576782*^9, 3.6517433661203547`*^9}, 3.6517443410124335`*^9, 
   3.6517445105187864`*^9, 3.6517446204814*^9, 3.651744701116542*^9, 
   3.651744758133977*^9, 3.651744813089469*^9, 3.6517448882799606`*^9, 
   3.651745157410062*^9, 3.6517451955328016`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\:5c55\:793a\:6765\:81ea\:6587\:4ef6\:7684\:89e3\:6570\:636e\:ff08\:884c\
\:8fd0\:884c1\:ff09", "Subsection",
 CellChangeTimes->{{3.6517302445230627`*^9, 3.6517302761458015`*^9}, 
   3.6517415521839504`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\:53ef\:8c03\:53c2\:6570", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sK", "=", "1"}], ";"}], 
   RowBox[{
   "(*", "\:9009\:62e9\:5c55\:793a\:54ea\:4e00\:4e2a\:5f00\:5c40\:7684\:89e3",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k", "=", "1"}], ";"}], 
   RowBox[{
   "(*", "\:9009\:62e9\:5c55\:793a\:8be5\:5f00\:5c40\:7684\:54ea\:4e00\:4e2a\
\:89e3", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"time", "=", "0.5"}], ";"}], 
   RowBox[{"(*", "\:95f4\:9694\:65f6\:95f4", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
       "===", "===", "===", "===", "===", "===", "==="}], "="}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"startData", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"#", ",", "\"\< \>\""}], "]"}], "&"}], "/@", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"sK", ",", "3"}], "]"}], "]"}], ",", "\"\<\\n\>\""}], 
       "]"}]}]}], ";", 
    RowBox[{"(*", "\:5f00\:5c40\:6570\:636e", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"endData", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"#", ",", "\"\< \>\""}], "]"}], "&"}], "/@", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"sK", ",", "4"}], "]"}], "]"}], ",", "\"\<\\n\>\""}], 
       "]"}]}]}], ";", 
    RowBox[{"(*", "\:7ed3\:675f\:6570\:636e", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"endPos", "=", 
     RowBox[{"Position", "[", 
      RowBox[{"endData", ",", 
       RowBox[{"_", "?", "LetterQ"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"Heads", "\[Rule]", "False"}]}], "]"}]}], ";", 
    RowBox[{"(*", "\:7ed3\:675f\:65f6\:68cb\:5b50\:7684\:4f4d\:7f6e", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"endLetters", "=", 
     RowBox[{"Extract", "[", 
      RowBox[{"endData", ",", "endPos"}], "]"}]}], ";", 
    RowBox[{
    "(*", "\:7ed3\:675f\:65f6\:5bf9\:5e94\:4f4d\:7f6e\:4e0a\:7684\:68cb\:5b50\
\:5b57\:6bcd", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"packTypeRule", "=", 
     RowBox[{"letterToTypeN", "[", "startData", "]"}]}], ";", 
    RowBox[{"(*", "\:68cb\:5b50\:5206\:7c7b\:89c4\:5219", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"rows", "=", 
     RowBox[{"Length", "[", "startData", "]"}]}], ";", 
    RowBox[{"(*", "\:68cb\:76d8\:884c\:6570", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"columns", "=", 
     RowBox[{"Length", "[", 
      RowBox[{"startData", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
    RowBox[{"(*", "\:68cb\:76d8\:5217\:6570", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"vacancyN", "=", 
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "startData", "]"}], ",", "\"\<#\>\""}], 
      "]"}]}], ";", 
    RowBox[{"(*", "\:7a7a\:4f4d\:6570", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"da", "=", 
     RowBox[{"fromBriefCode", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"path", "<>", "\"\<SolveData\\\\SolveData[\>\"", "<>", 
            RowBox[{"ToString", "[", "1", "]"}], "<>", "\"\<].txt\>\""}], 
           "]"}], ",", "\"\<\\n\>\""}], "]"}], "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", "columns"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "\:4ece\:7b80\:8bb0\:7801\:8f6c\:6362\:4e3a\:77e9\:9635\:5f62\:5f0f\:7684\
\:6570\:636e", "\:ff0c", "\:4ee5\:4fbf\:5c55\:793a"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"allLetters", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{
         RowBox[{"da", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \>\""}], "]"}], ",", 
       RowBox[{"x_", "/;", 
        RowBox[{
         RowBox[{"x", "==", "\"\<@\>\""}], "||", 
         RowBox[{"x", "==", "\"\<#\>\""}]}]}]}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "\:6240\:6709\:4e0d\:540c\:7684\:68cb\:5b50", "\:ff0c", 
      "\:53bb\:9664\:7a7a\:4f4d\:548c\:56fa\:5b9a\:68cb\:5b50"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"colorRules", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<@\>\"", "\[Rule]", 
         RowBox[{"GrayLevel", "[", "0.3", "]"}]}], ",", 
        RowBox[{"\"\<#\>\"", "\[Rule]", "Black"}], ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"allLetters", "\[Rule]", 
          RowBox[{
           RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "/@", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "[", "allLetters", "]"}]}], "]"}]}]}], "]"}]}],
        "}"}], "]"}]}], ";", 
    RowBox[{"(*", "\:989c\:8272\:89c4\:5219", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"kk", "=", 
     RowBox[{"nn", "=", 
      RowBox[{"Length", "[", "da", "]"}]}]}], ";", 
    RowBox[{"(*", "\:89e3\:7684\:957f\:5ea6", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Dynamic", "[", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{"kk", ",", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"unPack", "[", 
           RowBox[{
            RowBox[{"da", "[", 
             RowBox[{"[", "kk", "]"}], "]"}], ",", "columns"}], "]"}], ",", 
          RowBox[{"Background", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", "None", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"unPack", "[", 
                    RowBox[{
                    RowBox[{"da", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}], ",", "columns"}], "]"}], 
                    ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "->", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
                "colorRules"}], ",", "1"}], "]"}]}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", "None", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"CoordinateBounds", "[", 
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"unPack", "[", 
                    RowBox[{
                    RowBox[{"da", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}], ",", "columns"}], "]"}], 
                    ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "\[Rule]",
                   "True"}], "&"}], "/@", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"colorRules", ",", 
                  RowBox[{"\"\<#\>\"", "\[Rule]", "_"}]}], "]"}]}], ")"}], 
              "~", "Join", "~", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"unPack", "[", 
                   RowBox[{
                    RowBox[{"da", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}], ",", "columns"}], "]"}], 
                  ",", "\"\<#\>\""}], "]"}], "\[Rule]", "True"}], "]"}]}]}], 
            "}"}]}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Thickness", "[", "3", "]"}], ",", "Black"}], "]"}]}], 
          ",", 
          RowBox[{"ItemSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"2.5", ",", "3"}], "}"}]}], ",", 
          RowBox[{"Spacings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}]}], ",", 
          RowBox[{"Alignment", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Center", ",", "Center"}], "}"}]}], ",", 
          RowBox[{"ItemStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Section\>\"", ",", "Black"}], "}"}]}]}], "]"}]}], 
       "}"}], "]"}], "]"}]}], 
   RowBox[{"(*", "\:5c55\:793a", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Pause", "[", "time", "]"}], ";"}], ",", 
      RowBox[{"{", 
       RowBox[{"kk", ",", "nn"}], "}"}]}], "]"}], ";", 
    RowBox[{"(*", "\:66f4\:65b0\:6b65\:9aa4kk", "*)"}], 
    "\[IndentingNewLine]"}]}]}]], "Input",
 CellChangeTimes->{{3.6517303530272675`*^9, 3.651730354848735*^9}, {
   3.651730501063797*^9, 3.6517305230159492`*^9}, 3.651730585700999*^9, {
   3.6517415114873276`*^9, 3.651741535886715*^9}}],

Cell[BoxData[
 DynamicBox[ToBoxes[
   Column[{$CellContext`kk, 
     Grid[
      Klotski`unPack[
       Part[$CellContext`da, $CellContext`kk], $CellContext`columns], 
      Background -> {None, None, 
        Flatten[
         Map[Thread[Position[
             Klotski`unPack[
              Part[$CellContext`da, $CellContext`kk], $CellContext`columns], 
             Part[#, 1]] -> Part[#, 2]]& , $CellContext`colorRules], 1]}, 
      Frame -> {None, None, 
        Join[
         Map[CoordinateBounds[
            Position[
             Klotski`unPack[
              Part[$CellContext`da, $CellContext`kk], $CellContext`columns], 
             Part[#, 1]]] -> True& , 
          DeleteCases[$CellContext`colorRules, "#" -> Blank[]]], 
         Thread[Position[
            Klotski`unPack[
             Part[$CellContext`da, $CellContext`kk], $CellContext`columns], 
            "#"] -> True]]}, FrameStyle -> Directive[
        Thickness[3], Black], ItemSize -> {2.5, 3}, Spacings -> {3, 3}, 
      Alignment -> {Center, Center}, ItemStyle -> {"Section", Black}]}], 
   StandardForm],
  ImageSizeCache->{1041., {22., 29.}}]], "Output",
 CellChangeTimes->{
  3.651730589085273*^9, 3.651741207769643*^9, {3.6517412798931956`*^9, 
   3.651741301815655*^9}, {3.6517415166204233`*^9, 3.6517415373682685`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.651730589085273*^9, 3.651741207769643*^9, {3.6517412798931956`*^9, 
   3.651741301815655*^9}, {3.6517415166204233`*^9, 3.65174154115292*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1075, 997},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (2015\:5e748\:670830\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 117, 2, 101, "Title"],
Cell[CellGroupData[{
Cell[722, 28, 218, 3, 70, "Section"],
Cell[943, 33, 2671, 59, 152, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[3651, 97, 265, 3, 56, "Section"],
Cell[CellGroupData[{
Cell[3941, 104, 313, 4, 49, "Subsection"],
Cell[CellGroupData[{
Cell[4279, 112, 15808, 351, 1179, "Input"],
Cell[20090, 465, 1321, 21, 69, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[21472, 493, 355, 5, 56, "Section"],
Cell[CellGroupData[{
Cell[21852, 502, 512, 7, 49, "Subsection"],
Cell[22367, 511, 665, 11, 68, "Text"],
Cell[CellGroupData[{
Cell[23057, 526, 11638, 254, 679, "Input"],
Cell[34698, 782, 2259, 42, 31, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[37018, 831, 300, 4, 56, "Section"],
Cell[CellGroupData[{
Cell[37343, 839, 252, 3, 49, "Subsection"],
Cell[CellGroupData[{
Cell[37620, 846, 9586, 206, 472, "Input"],
Cell[47209, 1054, 3927, 68, 383, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[51185, 1128, 213, 3, 41, "Subsection"],
Cell[CellGroupData[{
Cell[51423, 1135, 9169, 227, 472, "Input"],
Cell[60595, 1364, 1307, 30, 68, "Output"],
Cell[61905, 1396, 201, 3, 31, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
